function onMessageSendHandler(e){try{Office.context.mailbox.item.subject.getAsync(function(o){if(o.status===Office.AsyncResultStatus.Succeeded){var t=o.value||"";if(console.log("Subject:",t),t.length<3)return void e.completed({allowEvent:!1,errorMessage:"Subject must be at least 3 characters long.",errorMessageMarkdown:" **Subject too short**\n\nThe subject must be at least 3 characters.",cancelLabel:"Fix Subject",commandId:"msgComposeOpenPaneButton"});e.completed({allowEvent:!0})}else console.error("Failed to get subject:",o.error),e.completed({allowEvent:!0})})}catch(o){console.error("Error in onMessageSendHandler:",o),e.completed({allowEvent:!0})}}Office.onReady(function(){console.log("Add-in ready"),console.log("test send 1")}),Office.onReady(function(){console.log("Commands.js ready")});