{"version":3,"file":"commands.js","mappings":"AAAAA,OAAOC,QAAQ,WACbC,QAAQC,IAAI,gBACZD,QAAQC,IAAI,cACd,GAeAH,OAAOC,QAAQ,WACbC,QAAQC,IAAI,oBACd","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["Office.onReady(() => {\n  console.log(\"Add-in ready\");\n  console.log('test send 1');\n});\n\n// function onMessageSendHandler(event) {\n//   const item = Office.context.mailbox.item;\n\n//   // Read the subject\n//   const subject = item.subject || \"No subject\";\n\n//   // Alert it\n//   alert(\"Subject: \" + subject);\n\n//   // Allow sending\n//   event.completed({ allowEvent: true });\n// }\n\nOffice.onReady(() => {\n  console.log(\"Commands.js ready\");\n});\n\nfunction onMessageSendHandler(event) {\n  try {\n    const item = Office.context.mailbox.item;\n\n    item.subject.getAsync(function (asyncResult) {\n      if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n        const subject = asyncResult.value || \"\";\n\n        console.log(\"Subject:\", subject);\n\n        if (subject.length < 3) {\n\n          event.completed({\n            allowEvent: false,\n            errorMessage: \"Subject must be at least 3 characters long.\",\n            errorMessageMarkdown: \" **Subject too short**\\n\\nThe subject must be at least 3 characters.\",\n            cancelLabel: \"Fix Subject\",\n            commandId: \"msgComposeOpenPaneButton\"\n          });\n          return;\n        }\n\n        event.completed({ allowEvent: true });\n\n      } else {\n        console.error(\"Failed to get subject:\", asyncResult.error);\n        event.completed({ allowEvent: true }); // fallback\n      }\n    });\n\n  } catch (err) {\n    console.error(\"Error in onMessageSendHandler:\", err);\n    event.completed({ allowEvent: true }); // fallback\n  }\n}\n\n\n\n\n\n"],"names":["Office","onReady","console","log"],"sourceRoot":""}